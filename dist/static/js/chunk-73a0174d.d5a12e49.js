(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-73a0174d"],{"053f":function(t,e,i){"use strict";var a=i("07cf"),s=i.n(a);s.a},"07cf":function(t,e,i){},"3d7a":function(t,e,i){"use strict";i.d(e,"c",(function(){return s})),i.d(e,"d",(function(){return l})),i.d(e,"b",(function(){return r})),i.d(e,"a",(function(){return n})),i.d(e,"e",(function(){return o}));var a=i("b775");function s(t){return Object(a["a"])({url:"/sys/task/detail/"+t,method:"get"})}function l(t){return Object(a["a"])({url:"/sys/task/state/finish/",method:"put",data:t})}function r(t){return Object(a["a"])({url:"/sys/task/accept/finish/",method:"put",data:t})}function n(t){return Object(a["a"])({url:"/sys/task/accept/",method:"post",data:t})}function o(t){return Object(a["a"])({url:"/sys/user/reregister",method:"put",data:t})}},c35e:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"container"},[i("el-breadcrumb",{staticClass:"headerTitle",attrs:{separator:"/"}},[i("el-breadcrumb-item",{attrs:{to:{path:"/assignment"}}},[t._v("任务平台")]),i("el-breadcrumb-item",[t._v("任务详情")])],1),i("div",{staticClass:"content"},[i("div",{staticClass:"titleContent"},[i("div",{staticStyle:{"line-height":"20px",color:"#333333","font-size":"14px","font-weight":"600"}},[t._v(t._s(t.assignmentData.title)+" ")]),i("div",{staticStyle:{"margin-top":"10px",width:"100%",display:"inline-flex"}},[i("div",{staticClass:"titleItem"},[i("div",{staticStyle:{"line-height":"20px",height:"20px",overflow:"hidden","text-overflow":"ellipsis",display:"-webkit-box","-webkit-line-clamp":"1","-webkit-box-orient":"vertical"}},[i("i",{staticClass:"iconfont iconicon_user",staticStyle:{"font-size":"12px"},attrs:{title:t.assignmentData.publisherName}},[i("span",{staticStyle:{"margin-left":"5px"}},[t._v("发布者："+t._s(t.assignmentData.publisherName))])])])]),i("div",{staticClass:"titleItem",staticStyle:{"margin-left":"30px"}},[i("div",{staticStyle:{"line-height":"20px",height:"20px",overflow:"hidden","text-overflow":"ellipsis",display:"-webkit-box","-webkit-line-clamp":"1","-webkit-box-orient":"vertical"}},[i("i",{staticClass:"iconfont iconicon_time",staticStyle:{"font-size":"12px"}},[i("span",{staticStyle:{"margin-left":"5px"}},[t._v("发布时间："+t._s(t.assignmentData.publishertime))])])])]),i("div",{staticClass:"titleItem",staticStyle:{"margin-left":"30px"}},[i("div",{staticStyle:{"line-height":"20px",height:"20px",overflow:"hidden","text-overflow":"ellipsis",display:"-webkit-box","-webkit-line-clamp":"1","-webkit-box-orient":"vertical"}},[i("i",{staticClass:"iconfont iconicon_time",staticStyle:{"font-size":"12px"}},[i("span",{staticStyle:{"margin-left":"5px"}},[t._v("截止时间："+t._s(t.assignmentData.deadlinetime))])])])]),i("div",{staticClass:"titleItem",staticStyle:{"margin-left":"30px"}},[i("div",{staticStyle:{"line-height":"20px",height:"20px",overflow:"hidden","text-overflow":"ellipsis",display:"-webkit-box","-webkit-line-clamp":"1","-webkit-box-orient":"vertical"}},[i("i",{staticClass:"iconfont iconbianzu4",staticStyle:{"font-size":"12px"}},[i("span",{staticStyle:{"margin-left":"5px"}},[t._v("状态："+t._s(t._f("statusFilter")(t.assignmentData.sp1)))])])])])])]),i("div",{staticClass:"contentDetail"},[t._m(0),i("div",{staticClass:"assignmentDataFont",staticStyle:{"margin-left":"10px","margin-top":"13px"},domProps:{innerHTML:t._s(t.assignmentData.details)}})]),i("div",{staticStyle:{height:"1px","background-color":"#EBEEF5",width:"100%","margin-top":"20px"}}),i("div",{staticClass:"contentDetail"},[t._m(1),i("div",{staticClass:"fileContent"},[i("div",{staticStyle:{"margin-top":"10px",width:"100%"}},[i("el-table",{staticStyle:{width:"100%"},attrs:{slot:"empty",data:t.assignmentData.fileVOList,"show-header":!1,"empty-text":"无附件"},slot:"empty"},[i("el-table-column",{attrs:{prop:"name",label:"文件名"}}),i("el-table-column",{attrs:{label:"下载"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",{staticStyle:{color:"#40A9FF","text-decoration":"underline"},on:{click:function(i){return t.handleShowDetail(e.row.id)}}},[t._v("下载")])]}}])})],1)],1)])]),i("div",{staticStyle:{height:"1px","background-color":"#EBEEF5",width:"100%","margin-top":"28px"}}),t.userInfo?i("div",{staticStyle:{width:"100%","padding-top":"40px","text-align":"center"}},[i("el-button",{staticClass:"dev-button",style:t.test(t.taskAction),attrs:{type:"primary"},on:{click:t.finishTask}},[t._v(" "+t._s(t.taskAction)+" ")]),i("div",{staticClass:"assigntips"},[t._v("注：发布者可在截止日期前主动结束任务，已结束的任务不可继续报名结束任务")])],1):t._e(),i("el-dialog",{staticStyle:{"border-radius":"5px"},attrs:{width:"400px",visible:t.modelShow,center:"","close-on-press-escape":!1},on:{"update:visible":function(e){t.modelShow=e}}},[i("div",{attrs:{slot:"title"},slot:"title"},[i("div",{staticClass:"login-name",staticStyle:{"font-weight":"600"}},[t._v("报名接包")])]),i("el-form",{ref:"form",staticStyle:{"text-align":"center"},attrs:{model:t.form,size:"small","label-position":"left","label-width":"90px"}},[i("el-row",{staticStyle:{margin:"0px 40px 0px 10px"}},[i("el-form-item",{attrs:{label:"联系方式",prop:"contractWay"}},[i("el-input",{attrs:{maxlength:"11"},model:{value:t.form.contractWay,callback:function(e){t.$set(t.form,"contractWay",e)},expression:"form.contractWay"}})],1)],1),i("el-button",{staticClass:"loginbutton",staticStyle:{width:"120px","margin-bottom":"20px"},attrs:{type:"primary"},on:{click:t.handleAccept}},[t._v("接 包 ")])],1)],1),i("el-dialog",{staticClass:"registerDialog",staticStyle:{"border-radius":"5px"},attrs:{width:"50%",height:"100%",visible:t.modelRegisterShow,center:"","close-on-press-escape":!1},on:{"update:visible":function(e){t.modelRegisterShow=e}}},[i("div",{attrs:{slot:"title"},slot:"title"},[i("div",{staticClass:"login-name",staticStyle:{"font-weight":"600"}},[t._v("请完善个人信息")])]),i("el-form",{ref:"registerForm",staticStyle:{padding:"0 50px",display:"inline"},attrs:{model:t.registerForm,rules:t.rules,size:"small"}},[i("el-row",[i("el-form-item",{staticClass:"tipsWidth45",staticStyle:{width:"45%",display:"inline-block"},attrs:{prop:"userrole"}},[i("div",{staticStyle:{display:"inline-block",width:"45%","text-align":"right"}},[t._v("用户类型：")]),i("el-select",{staticStyle:{display:"inline-block",width:"50%","margin-left":"15px"},attrs:{placeholder:"请选择"},model:{value:t.registerForm.userrole,callback:function(e){t.$set(t.registerForm,"userrole",e)},expression:"registerForm.userrole"}},t._l(t.options,(function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),i("el-form-item",{staticClass:"tipsWidth45",staticStyle:{width:"45%",display:"inline-block",visibility:"hidden"}},[i("div",{staticStyle:{display:"inline-block",width:"45%","text-align":"right"}},[t._v("用户类型：")]),i("el-input",{staticClass:"search-input",staticStyle:{display:"inline-block",width:"50%","margin-left":"15px"}})],1),i("el-form-item",{staticClass:"tipsWidth45",staticStyle:{width:"45%",display:"inline-block"},attrs:{prop:"username"}},[i("div",{staticStyle:{display:"inline-block",width:"45%","text-align":"right"}},[t._v("用户名：")]),i("el-input",{staticClass:"search-input",staticStyle:{display:"inline-block",width:"50%","margin-left":"15px"},attrs:{maxlength:"49",disabled:""},model:{value:t.registerForm.username,callback:function(e){t.$set(t.registerForm,"username",e)},expression:"registerForm.username"}})],1),i("el-form-item",{staticClass:"tipsWidth45",staticStyle:{width:"45%",display:"inline-block"},attrs:{prop:"contactName"}},[i("div",{staticStyle:{display:"inline-block",width:"45%","text-align":"right"}},[t._v("联系人：")]),i("el-input",{staticClass:"search-input",staticStyle:{display:"inline-block",width:"50%","margin-left":"15px"},attrs:{maxlength:"9"},model:{value:t.registerForm.contactName,callback:function(e){t.$set(t.registerForm,"contactName",e)},expression:"registerForm.contactName"}})],1),i("el-form-item",{staticClass:"tipsWidth45",staticStyle:{width:"45%",display:"inline-block"},attrs:{prop:"contactTel"}},[i("div",{staticStyle:{display:"inline-block",width:"45%","text-align":"right"}},[t._v("联系电话 ：")]),i("el-input",{staticClass:"search-input",staticStyle:{display:"inline-block",width:"50%","margin-left":"15px"},attrs:{maxlength:"11"},model:{value:t.registerForm.contactTel,callback:function(e){t.$set(t.registerForm,"contactTel",e)},expression:"registerForm.contactTel"}})],1),i("el-form-item",{staticClass:"tipsWidth45",staticStyle:{width:"45%",display:"inline-block"},attrs:{prop:"contactEmail"}},[i("div",{staticStyle:{display:"inline-block",width:"45%","text-align":"right"}},[t._v("联系邮箱：")]),i("el-input",{staticClass:"search-input",staticStyle:{display:"inline-block",width:"50%","margin-left":"15px"},attrs:{maxlength:"29"},model:{value:t.registerForm.contactEmail,callback:function(e){t.$set(t.registerForm,"contactEmail",e)},expression:"registerForm.contactEmail"}})],1),i("el-form-item",{staticClass:"tipsWidth",staticStyle:{width:"90%",display:"inline-block"},attrs:{prop:"mailAddress"}},[i("div",{staticStyle:{display:"inline-block",width:"22.5%","text-align":"right"}},[t._v("通信地址：")]),i("el-input",{staticClass:"search-input",staticStyle:{display:"inline-block",width:"75%","margin-left":"15px"},attrs:{maxlength:"499"},model:{value:t.registerForm.mailAddress,callback:function(e){t.$set(t.registerForm,"mailAddress",e)},expression:"registerForm.mailAddress"}})],1),i("el-form-item",{staticClass:"tipsWidth45",staticStyle:{width:"45%",display:"inline-block"},attrs:{prop:"idcardup"}},[i("div",{staticStyle:{display:"inline-block",width:"45%","text-align":"right","line-height":"135px"}},[t._v(" 身份证正面： ")]),i("el-upload",{staticClass:"avatar-uploader",staticStyle:{display:"inline-block",width:"212px",height:"135px",border:"1px solid #ccc","border-radius":"5px","margin-left":"15px"},attrs:{action:"/api/upload","show-file-list":!1,"on-success":t.uploadSuccess}},[t.registerForm.idcardupfilePath?i("img",{staticClass:"avatar",attrs:{src:t.registerForm.idcardupfilePath}}):i("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),i("el-form-item",{staticClass:"tipsWidth45",staticStyle:{width:"45%",display:"inline-block"},attrs:{prop:"idcarddown"}},[i("div",{staticStyle:{display:"inline-block",width:"45%","text-align":"right","line-height":"135px"}},[t._v(" 身份证背面： ")]),i("el-upload",{staticClass:"avatar-uploader",staticStyle:{display:"inline-block",width:"212px",height:"135px",border:"1px solid #ccc","border-radius":"5px","margin-left":"15px"},attrs:{action:"/api/upload","show-file-list":!1,"on-success":t.uploadidcarddownSuccess}},[t.registerForm.idcarddown?i("img",{staticClass:"avatar",attrs:{src:t.registerForm.idcarddownfilePath}}):i("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)],1),i("div",{staticStyle:{width:"100%","text-align":"center"}},[i("el-button",{staticClass:"loginbutton",staticStyle:{width:"300px","margin-bottom":"20px","margin-top":"20px"},attrs:{type:"primary"},on:{click:t.handleRegister}},[t._v("提 交 ")])],1)],1)],1)],1)],1)},s=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{display:"inline-flex"}},[i("div",{staticStyle:{width:"3px",height:"20px",background:"rgba(48,99,246,1)",display:"inline-block"}}),i("div",{staticStyle:{height:"20px","font-size":"14px","font-weight":"600",color:"rgba(51,51,51,1)","line-height":"20px",display:"inline-block","margin-left":"5px"}},[t._v(" 任务详情 ")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{display:"inline-flex"}},[i("div",{staticStyle:{width:"3px",height:"20px",background:"rgba(48,99,246,1)",display:"inline-block"}}),i("div",{staticStyle:{height:"20px","font-size":"14px","font-weight":"600",color:"rgba(51,51,51,1)","line-height":"20px",display:"inline-block","margin-left":"5px"}},[t._v(" 任务附件 ")])])}],l=i("3d7a"),r=i("cf45"),n=function(t,e,i){var a=/^[1][3,4,5,7,8][0-9]{9}$/;!a.test(e)&&e?i(new Error("请输入正确的手机号")):i()},o=function(t,e,i){var a=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;!a.test(e)&&e?i(new Error("邮箱格式不正确")):i()},c={name:"AssignmentDetail",filters:{statusFilter:function(t){var e={0:"任务中",1:"已完成"};return e[t]}},data:function(){return{userInfo:localStorage.getItem("userInfo"),options:[{value:"2",label:"个人用户"}],modelShow:!1,modelRegisterShow:!1,assignmentId:this.$route.params.id,listQuery:{page:1,pageSize:10},form:{contractWay:"",taskId:this.$route.params.id},registerForm:{userrole:"2",contactName:"",username:"",userpassword:"",contactTel:"",contactEmail:"",mailAddress:"",idcardup:"",idcardupfilePath:"",idcarddown:"",idcarddownfilePath:""},rules:{contactName:[{required:!0,message:"联系人不能为空",trigger:"blur"}],contactTel:[{required:!1,message:"联系电话不能为空",trigger:"blur"},{validator:n,trigger:"blur"}],contactEmail:[{required:!1,message:"邮箱不能为空",trigger:"blur"},{validator:o,trigger:"blur"}],mailAddress:[{required:!1,message:"通信地址不能为空",trigger:"blur"}],idcardup:[{required:!1,message:"请上传身份证正面照片",trigger:"blur"}],idcarddown:[{required:!1,message:"请上传身份证背面照片",trigger:"blur"}]},copyQuery:{page:1,pageSize:10},total:0,taskAction:"",assignmentData:{title:"",publishertime:"",deadlinetime:"",details:"",fileVOList:[]},honourList:[{id:1,color:"#FBCA03",userName:"创始人",taskNum:"15"},{id:2,color:"#ABC5E2",userName:"quyueming",taskNum:"9"}]}},created:function(){this.getAssignmentDetail()},methods:{back:function(){window.history.back()},handleShowDetail:function(t){var e="/api/download/"+t;window.open(e)},test:function(t){return"已停止接包"===t?{background:"#cccccc"}:"结束接包"===t?{background:"#418cee"}:"接包成功"===t?{background:"#85ce61"}:void 0},getAssignmentDetail:function(){var t=this;Object(l["c"])(this.assignmentId).then((function(e){localStorage.getItem("userInfoId")==e.data.creatorId?1==e.data.sp1?t.taskAction="已停止接包":t.taskAction="结束接包":0==e.data.acceptState?1==e.data.sp1?t.taskAction="已停止接包":t.taskAction="报名接包":t.taskAction="接包成功",t.assignmentData=e.data,t.test(t.taskAction)}))},pageQuery:function(){this.getList(this.copyQuery)},finishTask:function(){var t=this;if("结束接包"==this.taskAction){var e={};e.id=this.$route.params.id,e.sp1=1,Object(l["b"])(e).then((function(e){e.ok?(t.$message({message:"操作成功",type:"success",duration:2e3}),t.getAssignmentDetail()):t.$message({message:e.message,type:"error",duration:2e3})}))}else"报名接包"==this.taskAction&&("2"==localStorage.getItem("userInfoUserrole")&&1!=localStorage.getItem("userInfoAccountState")?this.register(JSON.parse(localStorage.getItem("userInfoDetail"))):(this.modelShow=!0,this.form={contractWay:"",taskId:this.$route.params.id}))},handleAccept:function(){var t=this,e=Object(r["a"])(this.form);this.loading=!0,Object(l["a"])(e).then((function(e){t.$message({message:"接包成功！",type:"success",duration:2e3,onClose:function(){t.modelShow=!1,t.getAssignmentDetail()}})}))},register:function(t){this.resetForm(t),this.modelRegisterShow=!0},resetForm:function(t){this.registerForm={userrole:"2",contactName:t.contactName,username:t.username,contactTel:t.contactTel,contactEmail:t.contactEmail,mailAddress:t.mailAddress,idcardup:t.idcardup,idcardupfilePath:t.idcardupfilePath,idcarddown:t.idcarddown,idcarddownfilePath:t.idcarddownfilePath}},uploadSuccess:function(t,e,i){t.ok?(this.registerForm.idcardup=t.data.id,this.registerForm.idcardupfilePath=t.data.url,this.$forceUpdate()):(this.registerForm.idcardup="",this.$forceUpdate(),this.$message.error(t.message))},uploadidcarddownSuccess:function(t,e,i){t.ok?(this.registerForm.idcarddown=t.data.id,this.registerForm.idcarddownfilePath=t.data.url,this.$forceUpdate()):(this.registerForm.idcarddown="",this.$forceUpdate(),this.$message.error(t.message))},handleRegister:function(){var t=this;this.$refs.registerForm.validate((function(e){if(!e)return console.log("error submit!!"),!1;var i=Object(r["a"])(t.registerForm);i.id=localStorage.getItem("userInfoId"),t.loading=!0,Object(l["e"])(i).then((function(e){t.$message({message:"个人信息提交成功！",type:"success",duration:2e3,onClose:function(){t.modelRegisterShow=!1,localStorage.setItem("userInfoDetail",JSON.stringify(e.data)),localStorage.setItem("userInfoId",e.data.id),localStorage.setItem("userInfoUserrole",e.data.userrole),localStorage.setItem("userInfoAccountState",e.data.accountState),t.userInfo=localStorage.getItem("userInfo")}})}))}))}}},d=c,p=(i("053f"),i("2877")),m=Object(p["a"])(d,a,s,!1,null,"6805b053",null);e["default"]=m.exports}}]);